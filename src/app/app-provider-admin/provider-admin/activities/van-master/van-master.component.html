<div class="row">
  <div *ngIf="showVans && !editable" class="col-xs-12 col-sm-12">
    <h4>Van Master</h4>
    <form #searForm="ngForm" autocomplete="off">
      <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
          <!-- <mat-input-container class="hide_underline" [style.width]="'100%'">
                        <input matInput style="display:none"> -->
          <mat-select
            required
            name="Services"
            placeholder="Serviceline"
            [style.width]="'100%'"
            [(ngModel)]="serviceline"
            (selectionChange)="
              getStates(serviceline.serviceID); resetform.reset()
            "
          >
            <mat-option *ngFor="let item of services_array" [value]="item">
              {{ item.serviceName }}
            </mat-option>
          </mat-select>
          <!-- </mat-input-container> -->
        </div>
        <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
          <!-- <mat-input-container class="hide_underline" [style.width]="'100%'">
                        <input matInput style="display:none"> -->
          <mat-select
            required
            placeholder="State"
            [style.width]="'100%'"
            [(ngModel)]="searchStateID"
            name="searchStateID"
            (selectionChange)="
              setProviderServiceMapID(searchStateID.providerServiceMapID);
              resetform.reset()
            "
          >
            <mat-option *ngFor="let state of provider_states" [value]="state">
              {{ state.stateName }}
            </mat-option>
          </mat-select>
          <!-- </mat-input-container> -->
        </div>
        <form #resetform="ngForm">
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
            <mat-select
              placeholder="Zone"
              class="width100"
              [(ngModel)]="zoneID"
              name="zoneID"
              #zone="ngModel"
              (selectionChange)="
                getAllParkingPlaces(
                  zoneID.zoneID,
                  searchStateID.providerServiceMapID
                )
              "
              required
            >
              <mat-option *ngFor="let zone of zones" [value]="zone">
                {{ zone.zoneName }}
              </mat-option>
            </mat-select>
          </div>
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
            <mat-select
              *ngIf="parkAndHub"
              placeholder="{{ parkAndHub }}"
              class="width100"
              [(ngModel)]="parking_place"
              name="parking_place"
              (selectionChange)="
                getVans(
                  searchStateID.providerServiceMapID,
                  parking_place.parkingPlaceID
                )
              "
              #parkingPlace="ngModel"
              required
            >
              <mat-option
                *ngFor="let parkingPlace of parkingPlaces"
                [value]="parkingPlace"
              >
                {{ parkingPlace.parkingPlaceName }}
              </mat-option>
            </mat-select>
          </div>
          <!-- <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12 m-t-15">
                        <mat-select placeholder="District" class="width100" [(ngModel)]="district" name="district" (selectionChange)="getVans(searchStateID.stateID,district.districtID,parking_place.parkingPlaceID);GetTaluks(parking_place.parkingPlaceID, district.districtID)"
                            #mappingDistrict='ngModel' required>
                            <mat-option *ngFor="let item of districts" [value]="item">
                                {{item.districtName}}
                            </mat-option>
                        </mat-select>
                    </div> -->
        </form>
      </div>
    </form>
  </div>
</div>
<div
  class="pull-right m-t-15"
  *ngIf="showVansTable && availableVans.length !== 0"
>
  <mat-form-field
    class="input-full-width mat_form_field_width_one"
    id="filterbox"
  >
    <input
      matInput
      placeholder="In-Table Search"
      #filterTerm
      (keyup)="filterComponentList(filterTerm.value)"
    />
    <md-icon matSuffix>search</md-icon>
  </mat-form-field>
</div>
<div class="row">
  <div *ngIf="showVansTable" class="col-xs-12 col-sm-12">
    <!-- <h4>Available Vans</h4> -->
    <div class="table-responsive">
      <table
        mat-table
        class="mat-elevation-z8"
        [dataSource]="filteredavailableVans"
      >
        <ng-container matColumnDef="sno">
          <th mat-header-cell *matHeaderCellDef>SNo.</th>
          <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
        </ng-container>
        <ng-container matColumnDef="parkingPlaceName">
          <th mat-header-cell *matHeaderCellDef>{{ parkAndHub }}</th>
          <td mat-cell *matCellDef="let element">
            {{ element.parkingPlaceName }}
          </td>
        </ng-container>
        <ng-container matColumnDef="vanName">
          <th mat-header-cell *matHeaderCellDef>{{ vanAndSpoke }}</th>
          <td mat-cell *matCellDef="let element">{{ element.vanName }}</td>
        </ng-container>
        <ng-container matColumnDef="vehicalNo">
          <th mat-header-cell *matHeaderCellDef>{{ code }}</th>
          <td mat-cell *matCellDef="let element">{{ element.vehicalNo }}</td>
        </ng-container>
        <ng-container matColumnDef="vanType">
          <th mat-header-cell *matHeaderCellDef>{{ codeType }}</th>
          <td mat-cell *matCellDef="let element">{{ element.vanType }}</td>
        </ng-container>
        <ng-container matColumnDef="edit">
          <th mat-header-cell *matHeaderCellDef>Edit</th>
          <td mat-cell *matCellDef="let element">
            <mat-icon
              matTooltip="Edit"
              class="mat-icon material-icons"
              role="img"
              aria-hidden="true"
              style="cursor: pointer"
              *ngIf="!element.deleted"
              (click)="editVanData(element)"
              >edit</mat-icon
            >
          </td>
        </ng-container>
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef>Action</th>
          <td mat-cell *matCellDef="let element">
            <button
              *ngIf="element.deleted"
              mat-raised-button
              color="accent"
              (click)="updateVanStatus(element)"
            >
              Activate
            </button>
            <button
              *ngIf="!element.deleted"
              mat-raised-button
              color="primary"
              (click)="updateVanStatus(element)"
            >
              Deactivate
            </button>
          </td>
        </ng-container>

        <!-- <thead>
                    <tr>
                        <th width="5%">S.No.</th>
                        <th width="12%">{{parkAndHub}}</th>
                        <th width="12%">{{vanAndSpoke}}</th>
                        <th width="10%">{{code}}</th>
                        <th width="10%">{{codeType}}</th>
                        <th width="5%">Edit</th>
                        <th width="10%">Action</th>
                    </tr>
                </thead> -->
        <!-- <tbody>
                    <tr *ngIf="md2.data.length == 0">
                        <td colspan="7" class="record-not-found">No records found</td>
                    </tr>
                    <tr *ngFor="let van of md2.data; let i = index ">
                        <td>{{filteredavailableVans.indexOf(van)+1}} </td>
                       
                        <td>{{van.parkingPlaceName}}</td>
                        <td>{{van.vanName}}</td>
                        <td>{{van.vehicalNo}}</td>
                        <td>{{van.vanType}}</td>
                        <td>
                            <md-icon mdTooltip="Edit" class="cursorPointer" *ngIf="van.deleted=='0'" (click)="editVanData(van)">mode_edit</md-icon>
                        </td>
                        <td *ngIf="van.deleted=='0'">
                            <button mat-raised-button color="primary" class="activateBtn" (click)="updateVanStatus(van)">Deactivate</button>
                        </td>
                        <td *ngIf="van.deleted=='1'">
                            <button mat-raised-button color="accent" class="activateBtn" (click)="updateVanStatus(van)">Activate</button>
                        </td>
  
                    </tr>
                </tbody> -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
      <div>
        <button
          mat-raised-button
          color="primary"
          [disabled]="!createButton"
          class="pull-right"
          (click)="showForm()"
        >
          Create New Van
        </button>
      </div>
    </div>
    <div
      class="pull-center"
      style="margin-top: 35px; text-align: center"
      *ngIf="filteredavailableVans.data.length === 0"
    >
      <strong>No Records Found</strong>
    </div>
    <mat-paginator
      [hidden]="filteredavailableVans.data.length === 0"
      [pageSizeOptions]="[5, 10, 20]"
      [pageSize]="5"
      showFirstLastButtons
    >
    </mat-paginator>
  </div>
  <div *ngIf="!showVans || editable" class="col-xs-12 col-sm-12">
    <h4 *ngIf="!editable">Create Van</h4>
    <h4 *ngIf="editable">Edit Van Details</h4>

    <form #vanForm="ngForm" autocomplete="off">
      <div class="row">
        <input
          matInput
          style="display: none"
          [(ngModel)]="vanID"
          name="vanID"
        />
        <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-10">
          <!-- <mat-input-container class="hide_underline" [style.width]="'100%'">
                        <input matInput style="display:none"> -->
          <mat-select
            required
            name="Services"
            placeholder="Serviceline"
            [style.width]="'100%'"
            [(ngModel)]="serviceline"
            [disabled]="true"
          >
            <mat-option *ngFor="let item of services_array" [value]="item">
              {{ item.serviceName }}
            </mat-option>
          </mat-select>
          <!-- </mat-input-container> -->
        </div>
        <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-10">
          <!-- <mat-input-container class="hide_underline" [style.width]="'100%'">
                        <input matInput style="display:none"> -->
          <mat-select
            required
            placeholder="State"
            [style.width]="'100%'"
            [(ngModel)]="searchStateID"
            name="searchStateID"
            [disabled]="true"
          >
            <mat-option *ngFor="let state of provider_states" [value]="state">
              {{ state.stateName }}
            </mat-option>
          </mat-select>
          <!-- </mat-input-container> -->
        </div>
        <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
          <mat-select
            required
            placeholder="Zone"
            class="width100"
            [disabled]="true"
            [(ngModel)]="zoneID"
            name="zoneID"
            #zoneG="ngModel"
            (selectionChange)="
              getAllParkingPlaces(
                zoneID.zoneID,
                searchStateID.providerServiceMapID
              )
            "
          >
            <mat-option *ngFor="let zone of zones" [value]="zone">
              {{ zone.zoneName }}
            </mat-option>
          </mat-select>
        </div>
        <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
          <mat-select
            *ngIf="parkAndHub"
            placeholder="{{ parkAndHub }}"
            class="width100"
            [disabled]="true"
            [(ngModel)]="parking_place"
            name="parking_place"
            #parking="ngModel"
            required
          >
            <mat-option
              *ngFor="let parkingPlace of parkingPlaces"
              [value]="parkingPlace"
            >
              {{ parkingPlace.parkingPlaceName }}
            </mat-option>
          </mat-select>
        </div>
        <!-- <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12 m-t-15">
                    <mat-select placeholder="District" class="width100" [disabled]="true" [(ngModel)]="district" name="district" (selectionChange)="getVans(searchStateID.stateID,district.districtID,parking_place.parkingPlaceID);GetTaluks(parking_place.parkingPlaceID, district.districtID)"
                        #mappingDistrict='ngModel' required>
                        <mat-option *ngFor="let item of districts" [value]="item">
                            {{item.districtName}}
                        </mat-option>
                    </mat-select>
                </div> -->
        <!-- <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-10">
                    <mat-input-container class="hide_underline width100">
                          <input matInput style="display:none">
                    <mat-select placeholder="Taluk/Sub District" class="width100" [(ngModel)]="talukID" name="talukID">
                        <mat-option *ngFor="let taluk of taluks" [value]="taluk">
                            {{taluk.districtBlockName}}
                        </mat-option>
                    </mat-select>
                    </mat-input-container>
                </div> -->
        <form #vanMasterForm1="ngForm" autocomplete="off">
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-10">
            <!-- <mat-input-container class="hide_underline" [style.width]="'100%'">
                            <input matInput style="display:none"> -->
            <mat-select
              required
              placeholder="{{ codeType }}"
              [style.width]="'100%'"
              [(ngModel)]="vanTypeID"
              name="vanTypeID"
              #vanTID="ngModel"
            >
              <mat-option
                *ngFor="let vanType of filteredVanTypes"
                value="{{ vanType.vanTypeID }}-{{ vanType.vanType }}"
              >
                {{ vanType.vanType }}
              </mat-option>
            </mat-select>
            <!-- </mat-input-container> -->
            <!-- <mat-hint [hidden]=vanTID.valid>
                            <span class="error_text" *ngIf="!vanTID.required  && ( vanTID.dirty || vanTID.touched)">Please select Van Type</span>
                        </mat-hint> -->
          </div>

          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15" VehicleNO>
            <mat-form-field class="input-full-width mat_form_field_width_one">
              <input
                matInput
                required
                placeholder="{{ vanAndSpoke }}"
                [(ngModel)]="vanName"
                name="vanName"
                maxlength="30"
                #vanN="ngModel"
                (keyup)="checkExistance(vanName)"
              />
              <mat-hint>
                <span
                  class="error_text"
                  *ngIf="!vanN.valid && (vanN.dirty || vanN.touched)"
                  >Please enter Van Name</span
                >
                <span class="error_text" *ngIf="vanN.valid && vanNameExist"
                  >Van already exists</span
                >
              </mat-hint>
            </mat-form-field>
          </div>
          <div class="clearfix visible-sm"></div>
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15" VehicleNONew>
            <mat-form-field class="input-full-width mat_form_field_width_one">
              <input
                matInput
                required
                placeholder="{{ code }}"
                [(ngModel)]="vehicalNo"
                name="vehicalNo"
                minlength="10"
                maxlength="13"
                #vehicleN="ngModel"
                (keyup)="checkVehicleExistance(vehicalNo)"
              />
              <mat-hint>
                <span
                  class="error_text"
                  *ngIf="
                    !vehicleN.valid && (vehicleN.dirty || vehicleN.touched)
                  "
                  >Enter min: 10, max 13</span
                >
                <span class="error_text" *ngIf="vehicleN.valid && vehicleExist"
                  >Vehicle no already exists</span
                >
              </mat-hint>
            </mat-form-field>
          </div>
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15" VehicleNONew>
            <mat-form-field
              class="input-full-width mat_form_field_width_one"
              myEmail
            >
              <input
                matInput
                placeholder="Swymed Domain"
                [(ngModel)]="domain"
                name="domain"
                #sDomain="ngModel"
              />
            </mat-form-field>
          </div>
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15" PAN>
            <mat-form-field class="input-full-width mat_form_field_width_one">
              <input
                matInput
                placeholder="Swymed ID"
                [(ngModel)]="sID"
                name="sID"
                #videoConsultationID="ngModel"
              />
            </mat-form-field>
          </div>
          <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 m-t-15">
            <mat-form-field class="input-full-width mat_form_field_width_one">
              <input
                matInput
                placeholder="Swymed Email"
                [(ngModel)]="sEmail"
                name="sEmail"
                #videoConsultationEmail="ngModel"
              />
            </mat-form-field>
            <span class="maxRedialNote">{{ note }}</span>
          </div>
          <div class="col-xs-12 col-sm-4 col-md-12 col-lg-3 m-t-15">
            <button
              mat-mini-fab
              color="primary"
              *ngIf="
                !editable &&
                vanMasterForm1.valid &&
                !vehicleExist &&
                !vanNameExist
              "
              class="xs-pull-right sm-pull-left md-pull-right lg-pull-left"
              (click)="
                addVanToList(vanMasterForm1.value); vanMasterForm1.reset()
              "
            >
              <md-icon
                matSuffix
                class="mat-icon material-icons"
                role="img"
                aria-hidden="true"
                style="cursor: pointer"
                >add</md-icon
              >
            </button>
          </div>
        </form>
      </div>
    </form>
    <div *ngIf="vanList.data.length > 0" class="m-t-10 table-responsive">
      <table mat-table [dataSource]="vanList" class="mat-elevation-z8">
        <ng-container matColumnDef="sno">
          <th mat-header-cell *matHeaderCellDef>SNo.</th>
          <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
        </ng-container>
        <ng-container matColumnDef="stateName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>State</th>
          <td mat-cell *matCellDef="let element">{{ element.stateName }}</td>
        </ng-container>
        <ng-container matColumnDef="parkingPlaceName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ parkAndHub }}
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.parkingPlaceName }}
          </td>
        </ng-container>
        <ng-container matColumnDef="vanName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ vanAndSpoke }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.vanName }}</td>
        </ng-container>
        <ng-container matColumnDef="vehicalNo">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ code }}</th>
          <td mat-cell *matCellDef="let element">{{ element.vehicalNo }}</td>
        </ng-container>
        <ng-container matColumnDef="vanType">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            {{ codeType }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.vanType }}</td>
        </ng-container>
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef>Action</th>
          <td mat-cell *matCellDef="let element; let i = index">
            <mat-icon
              class="cursorPointer"
              matTooltip="delete"
              (click)="deleteRow(vanList.data.indexOf(element))"
              >delete</mat-icon
            >
          </td>
        </ng-container>
        <!-- <thead>
                    <tr>
                        <th width="5%">S.No.</th>
                        <th width="15%">State</th>
                        <th width="12%">{{parkAndHub}}</th>
                        <th width="10%">{{vanAndSpoke}}</th>
                        <th width="10%">{{code}}</th>
                        <th width="10%">{{codeType}}</th>
                        <th width="10%">Action</th>
                    </tr>
                </thead> -->
        <!-- <tbody>
                    <tr *ngFor="let van of md2.data;let i = index">
                        <td>{{vanList.indexOf(van)+1}}</td>
                        <td>{{van.stateName}}</td>
                      
                        <td>{{van.parkingPlaceName}}</td>
                        <td>{{van.vanName}}</td>
                        <td>{{van.vehicalNo}}</td>
                        <td>{{van.vanType}}</td>
                        <td>
                            <md-icon class="cursorPointer" mdTooltip="delete" (click)="deleteRow(vanList.indexOf(van))">delete</md-icon>
                        </td>
                    </tr>
                </tbody> -->
        <tr mat-header-row *matHeaderRowDef="displayAddedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayAddedColumns"></tr>
        <mat-paginator
          [hidden]="vanList.data.length === 0"
          [pageSizeOptions]="[5, 10, 20]"
          [pageSize]="5"
          showFirstLastButtons
        >
        </mat-paginator>
      </table>
    </div>
    <div class="row m-t-10 m-b-20">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <button
          mat-raised-button
          color="primary"
          class="pull-left"
          (click)="back(); vanMasterForm1.reset()"
        >
          Back
        </button>

        <button
          mat-raised-button
          color="accent"
          *ngIf="editable"
          class="pull-right"
          (click)="updateVanData(vanMasterForm1.value); vanMasterForm1.reset()"
        >
          Update
        </button>
        <button
          mat-raised-button
          color="accent"
          [disabled]="!(vanList.data.length > 0)"
          *ngIf="!editable"
          class="pull-right"
          (click)="storeVans()"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</div>
